{
    "contents" : "---\ntitle: \"High School Demographics\"\nauthor: \"Hunter Ratliff, @HunterRatliff1\"\ndate: \"July 28, 2016\"\noutput: \n  html_document:\n    theme: united\n    highlight: zenburn\n    toc: true\n    toc_float: true\n    toc_depth: 2\n    code_folding: show\n---\n\n**Source Code:** Github:\n[HunterRatliff1/        ](https://github.com/HunterRatliff1/    )  \n**Published to:** `NA`   \n**Author:** `Hunter Ratliff` @[HunterRatliff1](https://twitter.com/HunterRatliff1)  \n\n\n\n\n```{r global_options, include=FALSE}\nrequire(knitr)\n\n## Sets output for figures\nknitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Demographics/',\n                      echo=FALSE, warning=FALSE, message=FALSE, fig.align='center')\n```\n\n\n```{r load_data}\nrequire(rio)\nrequire(dplyr)\nrequire(tidyr)\nrequire(stringr)\nrequire(ggplot2)\nrequire(googlesheets)\nrequire(ggthemes)\nrequire(scales)\n\nTest.Pre <- import(\"Data/Pre/Test.csv\", setclass=\"tbl_df\")\nTest.Post <- import(\"Data/Post/Test.csv\", setclass=\"tbl_df\")\nDems <- import(\"Data/Pre/Survey.RDS\")\n\ntheme_ <- theme_fivethirtyeight() + theme(axis.title=element_text()) \n```\n\n# Pre-Test Questions\n\n```{r Fig01, fig.width=6, fig.height=4, fig.cap='Figure 01'}\n# Density + Histogram of percentage correct\nTest.Pre %>% \n  group_by(SID) %>%\n  summarise(Score = sum(isCorrect)/n()) %>%\n  ggplot(aes(x=Score)) +\n  geom_histogram(aes(y=..density..), binwidth=0.06, alpha=0.75) +\n  geom_density() + \n  scale_x_continuous(labels=percent) + \n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(y=\"\", title=\"Pre-Test Score Distribution\")\n```\n\n```{r Fig02a, fig.cap='Figure 2A'}\n# Question Distribution (bars)\nTest.Pre %>% ggplot(aes(x=QID, fill=Score)) +\n  geom_bar(position=\"fill\") + \n  scale_fill_fivethirtyeight(name=\"\") +\n  scale_y_continuous(labels=percent, name=\"Percentage of Responses\") +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(x=\"\", title=\"Question Distribution :: Pre-Test\")\n```\n```{r Fig02b, fig.cap='Figure 2B'}\n## Facet by topic\nlast_plot() + facet_wrap(\"Topic\", scales=\"free\") + \n  labs(title=\"Question Distribution :: Pre-Test (Facet by Topic)\")\n```\n\n# Self-Identified Variables\n\nA few lines about methods can go here... Shouldn't be that complicated or long\n\n## [Q16] Languages Spoken at Home\n\nStudents listed the languages spoken in their home in decreasing order of \nfrequency. From these responses, five language variables were calculated: \n\n* <b>ML</b> - Multilingual household\n* <b>PHLOTE</b> - Primary home language other than english\n* <b>NES</b> - Non-english speaker, meaning meaning english is *not* spoken at all\n* <b>L1</b> - Primary language\n* <b>L2</b> - Secondary language\n\n```{r Fig03, fig.width=8, fig.height=5, fig.cap='Figure 3'}\ndf.lang <- Dems %>% count(ML, PHLOTE) %>%\n  filter(!is.na(ML)) \n\ndf.lang %>%\n  ggplot(aes(x=PHLOTE, y=n, fill=ML, label=str_c(n, \" students \"))) + \n  geom_bar(stat=\"identity\") +\n  geom_text(stat=\"identity\", position = \"stack\", size=5,\n            color=\"white\", vjust=0, hjust=1) +  coord_flip() +\n  scale_fill_stata(name=\"Multilingual (ML)\") +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(x=\"Primary Home Language Other Than English\\n(PHLOTE)\", \n       y=\"Number of Students\",\n       title=\"Languages Spoken at Home\")\n```\n\nThis can also be expressed in percentage format:\n\n+ Households that **only** speak english: \n<code>`r percent(filter(df.lang, !ML, !PHLOTE)$n / sum(df.lang$n))`</code>\n+ Households that **don't** speak english whatsoever: \n<code>`r percent(filter(df.lang, !ML, PHLOTE)$n / sum(df.lang$n))`</code>\n+ Households that speak **more than one language**: \n<code>`r percent(sum(filter(df.lang, ML)$n) / sum(df.lang$n))`</code> \n(with <code>`r percent(sum(filter(df.lang, PHLOTE, ML)) / sum(filter(df.lang, ML)$n))`</code> of these households having a PHLOTE)\n\n## [Q17] Gender Identification\n\nStudents were asked to select one or more boxes describing their gender \nidentification. The options the were provided are as follows: **Female**, \n**Male**, and/or **I'd prefer not answer**. Additionally, students were allowed \nto write in their own responses. For the purpose of analysis, all respponses  \nother than male or female have been categorized as **Other**.\n\n```{r Fig05, fig.width=8, fig.height=5, fig.cap='Figure 5'}\nDems %>% count(Gender, GradeLvl, sort=T) %>% \n  filter(!is.na(GradeLvl)) %>%\n  ggplot(aes(x=GradeLvl, y=n, fill=Gender)) + \n  geom_bar(stat=\"identity\") + #coord_flip() + \n  scale_fill_wsj(name=\"Grade Level\") +\n  theme_ + labs(subtitle=\"High School (2016)\", y=\"Number of Students\") +\n  labs(title=\"Students by Gender ID & Grade\")\n```\n  \n## [Q18] Race/Ethnicity Identification\n\nStudents were asked to select one or more boxes describing their racial/\nethnic identification among the options **White**, **Hispanic or Latina/o**, \n**Asian**, **American Indian or Alaska Native**, and **Native Hawaiian or Other \nPacific Islander**. Similar to the Gender identification question, respondants \nalso were given the option to write-in responses or select **I'd prefer not \nanswer**. Given the survey's limitations on this question (e.g. combining the \nethnicity question with the race question, the social construction of race)\nthese data were simplified into simple factors using the following heuristic:\n\n  1. If the Hispanic/Latina ethnicity was selected, the response was \n     categorized as `Hispanic (any combo)` regardless of race\n  2. If white, black, or Asian was the only response given, the response was \n     categorized as `White alone`, `Black alone`, or `Asian alone`\n  3. All other responses (including write-ins) were aggregated into `Other/2+ \n     Race ID`\n\nThe detailed Race/Ethnicity ID data are available in the \"Demographics\" table\n\n```{r Fig06, fig.width=7, fig.height=4, fig.cap='Figure 6'}\n# counts by gender & race\nDems %>% count(Race, Gender, sort=T) %>% \n  ggplot(aes(x=Race, y=n, fill=Gender, label=str_c(n, \" \"))) + \n  geom_bar(stat=\"identity\") + \n    geom_text(stat=\"identity\", position = \"stack\", size=5,\n            color=\"white\", vjust=.5, hjust=1) +  coord_flip() +\n  coord_flip() + \n  scale_fill_fivethirtyeight() +\n  theme_ + labs(subtitle=\"High School (2016)\", y=\"Number of Students\") +\n  labs(title=\"Students by race & gender ID\")\n```\n\n# Socioeconomic Indicator\n\n```{r Fig07, fig.cap='Figure 7'}\nDems %>% ggplot(aes(x=EO.sum, fill=Edu)) + \n  geom_histogram(binwidth=1, color=\"black\") +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(title=\"Students by EO Indicator & Parents Edu\") \n```\n\n```{r Fig08, fig.width=6, fig.height=4, fig.cap='Figure 8'}\nDems %>% ggplot(aes(x=EO.sum, y=Score, color=GradeLvl)) +\n  geom_jitter() + scale_y_continuous(labels=percent) +\n  scale_x_sqrt() + #guides(color=guide_legend(nrow=2)) +\n  scale_color_economist(name=\"Grade Level\") +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(title=\"Pre-Test Scores by sum of EO Indicator\") \n```\n\n# Pre & Post Test Scores\n\nAmong our Short-term Outcomes\n**Objective:** Through content-rich questions on pre-and post-tests, 85% of\nstudents will demonstrate knowedge gained - thus improved academic readiness.\n**Objective:** Through content-rich questions on pre-and post-tests, 85% of\nstudents will demonstrate increased science knowledge and preparedness for \nhealth professions.\n\n```{r Fig09, fig.cap='Figure 9'}\nDems %>% ggplot(aes(x=Edu, y=Score)) +\n  geom_violin(aes(fill=Edu)) +\n  geom_jitter(alpha=0.5) +\n  geom_boxplot(alpha=0.25, fill=\"white\") +\n  scale_y_continuous(labels=percent) +\n  guides(fill=F) + coord_flip() +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(title=\"Pre-Test Scores by Parents Edu\")\n```\n\n```{r Fig10a, fig.cap='Figure 10A'}\nDems %>% mutate(delta = Score2 - Score) %>% \n  ggplot() + geom_density(aes(x=Score), fill=\"grey\") +\n  geom_density(aes(x=Score2), fill=\"red\", alpha=.5) +\n  scale_x_continuous(labels=percent) +\n  # guides(fill=F) + coord_flip() +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(title=\"Pre-Test & Post-Test Scores\")\n```\n\n```{r Fig10b, fig.cap='Figure 10B'}\nlast_plot() + facet_wrap(\"Edu\")\n```  \n  \n```{r Fig11a, fig.cap='Figure 11a'}\nDems %>% \n  filter(!is.na(Edu), !is.na(GradeLvl)) %>%\n  ggplot(aes(x=Edu, y=Score, color=Edu, linetype=Gender)) +\n  geom_curve(aes(y=Score, yend=Score2, xend=Edu), position=\"jitter\",\n              curvature = -0.1, arrow = arrow(length = unit(0.3,\"cm\"))) +\n  scale_y_continuous(labels=percent) + coord_flip() +\n  guides(color=F) +#guide_legend(nrow=2)) +\n  # scale_color_brewer(name=\"Parent's Education\", palette = \"Spectral\") +\n  theme_ + labs(subtitle=\"High School (2016)\") +\n  labs(title=\"∆ Test Scores by Parents Educational Attainment\")   \n```\n\n```{r Fig11b, fig.cap='Figure 11B'}\nlast_plot() + facet_grid(GradeLvl~Race)\n# Dems %>% \n#   filter(!is.na(Edu)) %>%\n#   ggplot(aes(x=Race, y=Score, color=Edu)) +\n#   geom_curve(aes(y=Score, yend=Score2, xend=Race), position=\"jitter\",\n#               curvature = -0.1, arrow = arrow(length = unit(0.3,\"cm\"))) +\n#   scale_y_continuous(labels=percent) + coord_flip() +\n#   # guides(color=F) +#guide_legend(nrow=2)) +\n#   scale_color_brewer(name=\"Edu\", palette = \"Dark2\") +\n#   theme_ + labs(subtitle=\"High School (2016)\") +\n#   labs(title=\"∆ Test Scores by Parents Educational Attainment\")   +\n#   facet_grid(GradeLvl ~ Race)\n```\n# License\n\n```\n--- LICENSE ---\n\nCopyright (C) 2016 Hunter Ratliff\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <http://www.gnu.org/licenses/>.\n```\n\nThis is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.\n\nIn the spirit of [Reproducible Research](https://cran.r-project.org/web/views/ReproducibleResearch.html),\nbelow is the information About the R Session at the time it was compiled:\n\n```{r Session_info, echo=TRUE, collapse=TRUE}\ndevtools::session_info()\n```\n\n",
    "created" : 1469729353623.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "50|60|61|3|\n63|34|71|3|\n72|34|76|3|\n93|59|107|3|\n127|59|135|3|\n157|59|168|0|\n",
    "hash" : "2388712846",
    "id" : "B98DAB89",
    "lastKnownWriteTime" : 1470083954,
    "path" : "~/Github/EDU/HSSC2016/HS/Demographics.Rmd",
    "project_path" : "HS/Demographics.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_markdown"
}